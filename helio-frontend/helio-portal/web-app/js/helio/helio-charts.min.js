var helioChart;var chartObject;var chartContainer,additionalContainer,chartTitle;function createHELIOChart(containerName,additionalContainerName,chartTitleName,jsonObject){chartContainer=containerName;additionalContainer=additionalContainerName;chartTitle=chartTitleName;chartObject=new helioChartObject();chartObject.setJSON(jsonObject);chartObject.parseJSON(helioSeriesNames);var stringDropDown='<div id="selector"><form><p>';for(var m=0;m<chartObject.jsonObject.aoColumns.length;m++){var actual_sTitle=chartObject.jsonObject.aoColumns[m].sTitle;if((actual_sTitle!='time_start')&&(actual_sTitle!='time_peak')&&(actual_sTitle!='time_end')&&(actual_sTitle!='event_detail')&&(actual_sTitle!='comment')&&(actual_sTitle!='loc')){stringDropDown+='<input type="checkbox" name="seriesName" value="'+actual_sTitle+'">'+actual_sTitle+'<br />';}}
stringDropDown+='</p><p><input type="button" value="Display selected series" onclick="seriesSelectedRedraw(this.form)" /></p></form></div><br /><div id="range"></div>';document.getElementById(additionalContainerName).innerHTML=stringDropDown;createLineChart(chartContainer,additionalContainer,chartTitle,chartObject.dataStream,chartObject.yAxisArray);}
function seriesSelectedRedraw(form){var selectedNames=[];for(var i=0;i<form.elements.length;i++){var element=form.elements[i];if((element.type=='checkbox')&&(element.checked)){selectedNames.push(form.elements[i].value);}}
chartObject.parseJSON(selectedNames);createLineChart(chartContainer,additionalContainer,chartTitle,chartObject.dataStream,chartObject.yAxisArray);}
function helioChartObject(){this.jsonObject={};this.dataStream={};this.dataName="default series name";this.chartTitle="default chart title";this.yAxisArray=[];this.setJSON=setJSON;this.parseJSON=parseJSON;}
function setJSON(jsonVar){this.jsonObject=jsonVar;}
var helioColors=['#4572A7','#AA4643','#89A54E','#80699B','#3D96AE','#DB843D','#92A8CD','#A47D7C','#B5CA92'];var helioSeriesNames=['aastar_ave','aastar_max','aastar_sum','beta','delta_v','freq_start','freq_end','mag_ratio','pt_max','pt_max_sheath','b_max','b_max_sheath','v','v_init','v_final','v_20r','v_max','v_max_sheath'];function parseJSON(arrayOfSeriesNames){var aaDataObject=this.jsonObject.aaData;var lengthOfSeries=aaDataObject.length;var aoColumnsObject=this.jsonObject.aoColumns;var timesArray=[];var seriesNamesArray=[];var additionalDataArray=[];parseAoColumns(aoColumnsObject,timesArray,seriesNamesArray,additionalDataArray,arrayOfSeriesNames);var pointsPerObject=timesArray.length;pointsPerObject=pointsPerObject/3;var numberOfSeries=seriesNamesArray.length;numberOfSeries=numberOfSeries/3;var seriesObjectArray=[];this.yAxisArray.length=0;for(i=0;i<numberOfSeries;i++){var seriesObject={};seriesObject.name=seriesNamesArray[3*i];seriesObject.yAxis=i;var yAxisObject={};var yAxisObjectLabel={};var yAxisObjectLabelStyle={};yAxisObjectLabelStyle.color=helioColors[i%9];yAxisObjectLabel.style=yAxisObjectLabelStyle;yAxisObject.labels=yAxisObjectLabel;var yAxisObjectTitle={};var yAxisObjectTitleStyle={};yAxisObjectTitle.text=seriesNamesArray[3*i];yAxisObjectTitleStyle.color=helioColors[i%9];yAxisObjectTitle.style=yAxisObjectTitleStyle;yAxisObject.title=yAxisObjectTitle;this.yAxisArray.push(yAxisObject);var dataObjectArray=[];for(j=0;j<lengthOfSeries;j++){var latestDate;for(k=0;k<pointsPerObject;k++){var dataObject={};latestDate=parseDateFormat(aaDataObject[j][timesArray[(3*k)+1]+1]);dataObject.x=latestDate;if(seriesNamesArray[3*i+1]==-1){dataObject.y=i;}else{dataObject.y=aaDataObject[j][seriesNamesArray[3*i+1]+1];}
dataObject.xName=timesArray[3*k];dataObject.yName=seriesNamesArray[3*i];var additionalDataString='';for(l=0;l<(additionalDataArray.length/3);l++){additionalDataString+=additionalDataArray[l*3];additionalDataString+=': ';additionalDataString+=aaDataObject[j][additionalDataArray[l*3+1]+1];additionalDataString+='; ';}
additionalDataString=additionalDataString.slice(0,-2);dataObject.additionalInformation=additionalDataString;dataObjectArray.push(dataObject);}}
seriesObject.data=dataObjectArray;seriesObjectArray.push(seriesObject);}
this.dataStream=seriesObjectArray;}
function parseAoColumns(aoColumnsObject,timeArray,seriesNameArray,additionalDataArray,arrayOfSeriesNames){var numberOfItems=aoColumnsObject.length;for(var i=0;i<numberOfItems;i++){var actualItem=aoColumnsObject[i];var sTitelActualItem=actualItem.sTitle;if((sTitelActualItem=='time_start')||(sTitelActualItem=='time_peak')||(sTitelActualItem=='time_end')){timeArray.push(sTitelActualItem);timeArray.push(i);timeArray.push(actualItem);}else if(compareSeriesNames(sTitelActualItem,arrayOfSeriesNames)){seriesNameArray.push(sTitelActualItem);seriesNameArray.push(i);seriesNameArray.push(actualItem);}else{if(sTitelActualItem!='event_detail'){additionalDataArray.push(sTitelActualItem);additionalDataArray.push(i);additionalDataArray.push(actualItem);}}}
if(seriesNameArray.length==0){seriesNameArray.push('Events');seriesNameArray.push(-1);seriesNameArray.push(-1);}}
function parseDateFormat(stringToParse){if(stringToParse==undefined){return"-";}else{var splittedString=stringToParse.split('T');var dateString=splittedString[0];var timeString=splittedString[1];var splittedDateString=dateString.split('-');var splittedTimeString=timeString.split(':');var dateToReturn=new Date(splittedDateString[0],splittedDateString[1]-1,splittedDateString[2],splittedTimeString[0],splittedTimeString[1],splittedTimeString[2]);return dateToReturn;}}
function compareSeriesNames(stringToCompare,arrayOfSeriesNames){for(var i=0;i<arrayOfSeriesNames.length;i++){if(stringToCompare==arrayOfSeriesNames[i]){return true;}}
return false;}
function createLineChart(containerName,additionalContainerName,chartTitle,dataSeriesObject,yAxesObject){var options={chart:{ignoreHiddenSeries:true,renderTo:containerName,spacingTop:20,spacingRight:20,spacingBottom:30,spacingLeft:20,type:'scatter',zoomType:'xy',events:{selection:function(event){var min,max,ex2;if(event.xAxis){min=Highcharts.dateFormat('%Y-%m-%d %H:%M:%S',event.xAxis[0].min);max=Highcharts.dateFormat('%Y-%m-%d %H:%M:%S',event.xAxis[0].max);}else{min='-';max='-';}
var rangeString='<b>Range:</b><br />Minimum: ';rangeString+=min;rangeString+='<br />Maximum: ';rangeString+=max;document.getElementById('range').innerHTML=rangeString;}}},credits:{enabled:false},title:{text:chartTitle},plotOptions:{series:{turboThreshold:50000}},tooltip:{crosshairs:[true,true],formatter:function(){return'<b>'+this.point.xName+':</b> '+this.x+'; <b>'+this.point.yName+':</b> '+this.y+';<br /><b>Additional information:</b> '+this.point.additionalInformation;},shadow:false,snap:2},xAxis:{type:'datetime',minRange:1000},yAxis:[],series:[],exporting:{enabled:true}}
for(i=0;i<dataSeriesObject.length;i++){options.series.push(dataSeriesObject[i]);}
for(j=0;j<dataSeriesObject.length;j++){options.yAxis.push(yAxesObject[j]);}
helioChart=new Highcharts.Chart(options);}